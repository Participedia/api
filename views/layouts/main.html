<!DOCTYPE html>
<html lang="{{getLocale}}" class="no-focus-outline">

<head>
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,"script","https://www.google-analytics.com/analytics.js","ga");

    window.ga("create", "{{GA_TRACKING_ID}}", "auto");
    window.ga("send", "pageview");
  </script>
  <!-- End Google Analytics -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/style.css">

  {{{socialTagsTemplate article req}}}

  <title>{{getPageTitle req article}}</title>
</head>

{{!--
  We are using JS to make the html element visible when the fonts are loaded.
  In the case that the browser does not use JS, then just show the html element now.
--}}
<noscript><style>html { visibility: visible; }</style></noscript>

{{> modal }}

<body data-view="{{params.view}}">
  {{> header }}
  <main class="main-content">
    {{{ body }}}
  </main>
  {{> footer }}

  {{> contact-help-faq-popover }}

  {{> script-tag-with-cache-key filepath="/build/js/app.bundle.js"}}

  {{#if (isHomeSearchView req)}}
    {{!-- import google api for the map widget --}}
    <script type="text/javascript" src="/js/vendor/markerclustererplus.min.js"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key={{GOOGLE_API_KEY}}&libraries=places&language={{static.language}}"></script>
    {{> script-tag-with-cache-key filepath="/build/js/home-search-view.bundle.js"}}
    {{# if useInspectlet}}
      <!-- Begin Inspectlet Asynchronous Code -->
      <script type="text/javascript">
        (function() {
        window.__insp = window.__insp || [];
        __insp.push(['wid', 929677093]);
        var ldinsp = function(){
        if(typeof window.__inspld != "undefined") return; window.__inspld = 1; var insp = document.createElement('script'); insp.type = 'text/javascript'; insp.async = true; insp.id = "inspsync"; insp.src = ('https:' == document.location.protocol ? 'https' : 'http') + '://cdn.inspectlet.com/inspectlet.js?wid=929677093&r=' + Math.floor(new Date().getTime()/3600000); var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(insp, x); };
        setTimeout(ldinsp, 0);
        })();
      </script>
      <!-- End Inspectlet Asynchronous Code -->
    {{/if}}
  {{/if}}

  {{#if (isCollectionView req)}}
    {{> script-tag-with-cache-key filepath="/build/js/collection-view.bundle.js"}}
  {{/if}}

  {{#if (isEditView req)}}
    {{!-- import google api for the autocomplete widget --}}
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key={{GOOGLE_API_KEY}}&libraries=places&language={{static.language}}"></script>
    <script type="text/javascript" src="/js/polyfills/DragDropTouch.js"></script>
    {{> script-tag-with-cache-key filepath="/build/js/edit-view.bundle.js"}}
  {{/if}}

  {{#if (isNewView req)}}
    {{!-- import google api for the autocomplete widget --}}
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key={{GOOGLE_API_KEY}}&libraries=places&language={{static.language}}"></script>
    <script type="text/javascript" src="/js/polyfills/DragDropTouch.js"></script>
    {{> script-tag-with-cache-key filepath="/build/js/edit-view.bundle.js"}}
  {{/if}}

  {{#if (isReaderView req)}}
    <script type="text/javascript" src="/js/vendor/flickity@2.2.0-flickity.pkgd.js"></script>
    <script type="text/javascript" src="/js/vendor/flickity-fullscreen@1.1.1-fullscreen.js"></script>
    {{> script-tag-with-cache-key filepath="/build/js/reader-view.bundle.js"}}
  {{/if}}

  {{#if (isUserView req)}}
    {{> script-tag-with-cache-key filepath="/build/js/user-view.bundle.js"}}
  {{/if}}

  {{!-- initialize usersnap   --}}
  <script type="text/javascript">
  (function() { var s = document.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = '//api.usersnap.com/load/80049ef3-8aba-45c2-9a72-88b56bb1b342.js';
  var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();
  </script>

  <script type="text/javascript" src="/js/vendor/aria.modal.min.js"></script>
</body>

</html>
